---
layout: post
title: 第十四课
date: 2023-04-03
Author: 
categories: 
tags: [eNSP]
comments: false
toc: true
---

浮动静态路由：一种特殊的静态路由，通过配置去往相同的目的网段但优先级不同的静态路由，以保证在网络中优先级较高的路由被选择，即主路由失效的情况下提供备份路由。正常情况下，备份路由不出现在路由表中。

负载均衡：当数据有多条可选路径前往同一目的网络，可以通过配置相同优先级和开销的静态路由实现负载均衡，使得数据均衡分配到多条路径上，当其中某条路径失效时，其他路径仍然能正常传输数据。

# 浮动静态路游

当前往 `192.168.20.0` 时通过 `192.168.1.2` 为主用链路，通过 `192.168.2.2` 为备用链路，即当 `192.168.1.1` 与 `192.168.1.2` 之间的链路发生故障时，数据包通过 `192.168.2.2` 到达 `192.168.20.0`。此需求可通过浮动静态路由实现。

在命令 `ip route-static <Destination> <Mask> <NextHop>` 后跟 `preference <preference-value-range>` 设置优先级，默认为 60。

```shell
[Huawei]ip route-static 192.168.20.0 24 192.168.1.2
[Huawei]ip route-static 192.168.20.0 24 192.168.2.2 preference 100
[Huawei]
```

此时 Next Hop 为 192.168.1.2 的记录的优先级为 60，另一个是 100，优先使用前者。

# 负载均衡

当前往 `192.168.20.0` 时可以通过 `192.168.1.2` 与 `192.168.2.2` 时，可以将两个链路的优先级配置成相同的来实现负载均衡。

```shell
[Huawei]ip route-static 192.168.20.0 24 192.168.1.2 preference 100
[Huawei]ip route-static 194.168.20.0 24 192.168.2.2 preference 100
[Huawei]
```

此时两记录的优先级均为 100，路游器会将数据均衡分配到这两条路径上，当一条路径失效时，另一条仍然能正常传输。
